"use strict";angular.module("lockersApp",["ngCookies","ngResource","ngSanitize","ui.router","ui.bootstrap"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){b.otherwise("/"),c.html5Mode(!0)}]),angular.module("lockersApp").controller("AdminCtrl",["$scope","$log","Locker",function(a,b,c){function d(){a.lockersInUse=_.filter(a.lockers,function(a){return a.inUse}),a.buttonDisabled=!1}a.lockersInUse=[],a.lockers=[],c.query().$promise.then(function(b){a.lockers=b,d()}),a.wipeData=function(){a.buttonDisabled=!0,c.wipe().$promise.then(function(){a.lockers=[],d()})},a.createData=function(){console.log("createData"),a.buttonDisabled=!0,c.setup().$promise.then(function(b){console.log("returned from setup on server"),a.lockers=b,d()})},a.showByNumber=function(){a.selectedLocker=c.get({id:a.lockerNumber}),b.debug(a.selectedLocker)}}]),angular.module("lockersApp").config(["$stateProvider",function(a){a.state("admin",{url:"/admin",templateUrl:"app/admin/admin.html",controller:"AdminCtrl"})}]),angular.module("lockersApp").controller("MainCtrl",["$scope","$http","$log","Locker",function(a,b,c,d){function e(){d.query().$promise.then(function(b){a.lockers=b,a.smallCount=_.filter(b,function(a){return"small"===a.size}).length,a.smallCountInUse=_.filter(b,function(a){return"small"===a.size&&a.inUse}).length,a.mediumCount=_.filter(b,function(a){return"medium"===a.size}).length,a.mediumCountInUse=_.filter(b,function(a){return"medium"===a.size&&a.inUse}).length,a.largeCount=_.filter(b,function(a){return"large"===a.size}).length,a.largeCountInUse=_.filter(b,function(a){return"large"===a.size&&a.inUse}).length})}a.pickupMessage="",e(),a.dropOff=function(b){var c=_.chain(a.lockers).filter(function(a){return a.size===b&&!a.inUse}).first().value();a.checkedInLocker=c,c.inUse=!0,c.$update(),e()},a.pickUp=function(){var b=_.chain(a.lockers).filter(function(b){return b.slot===a.lockerNumber&&b.inUse}).first().value();b?(b.inUse=!1,b.$update(),a.pickupMessage="Slot "+a.lockerNumber+" is now available.",e()):a.pickupMessage="Yeah, I'm pretty sure somebody already picked up that locker's stuff."}}]),angular.module("lockersApp").config(["$stateProvider",function(a){a.state("main",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"})}]),angular.module("lockersApp").factory("Locker",["$resource",function(a){return a("/api/lockers/:id",{id:"@_id"},{update:{method:"PUT",params:{}},wipe:{method:"POST",url:"/api/lockers/clear",params:{}},setup:{method:"POST",url:"/api/lockers/setup",params:{},isArray:!0}})}]),angular.module("lockersApp").controller("NavbarCtrl",["$scope","$location",function(a,b){a.menu=[{title:"Home",link:"/"},{title:"Admin",link:"/admin"}],a.isCollapsed=!0,a.isActive=function(a){return a===b.path()}}]),angular.module("lockersApp").run(["$templateCache",function(a){a.put("app/admin/admin.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><div class=row><div class=col-md-12><h1>Administration!</h1><div><p>When you hit the <strong>Create data</strong> button, the locker database will be cleared and re-seeded with a starter set of data.</p><div><p>There are {{lockers.length}} lockers.</p></div><div class=row><input pattern=\\d* name=lockerNumber ng-model=lockerNumber value=1> <button class="btn btn-primary btn-large" name=show-by-number-button ng-click=showByNumber()>Show me</button> {{selectedLocker}}</div><button class="btn btn-primary btn-large" name=seed ng-click=wipeData() ng-disabled=buttonDisabled>Wipe data</button> <button class="btn btn-primary btn-large" name=seed ng-click=createData() ng-disabled=buttonDisabled>Create data</button><div class=col-lg-12><h3>{{lockersInUse.length}} lockers in use.</h3><p ng-repeat="locker in lockersInUse">Slot: {{locker.slot}}, Size: {{locker.size}}</p></div></div></div></div></div>'),a.put("app/main/main.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><header class=hero-unit id=banner><div class=container><h1>Lockers!</h1><p class=lead>Dump your stuff in our lockers.</p></div></header><div class=container><div class=row><div class=col-lg-12><p>Total: {{lockers.length}}</p><p>Small in use: {{smallCountInUse}} <button class="btn btn-primary" ng-click="dropOff(\'small\')">Drop off something small</button></p><p>Medium in use: {{mediumCountInUse}} <button class="btn btn-primary" ng-click="dropOff(\'medium\')">Drop off something just right</button></p><p>Large in use: {{largeCountInUse}} <button class="btn btn-primary" ng-click="dropOff(\'large\')">Drop off a big thing</button></p><p>{{checkedInLocker}}</p><p><form ng-submit=pickUp()><input pattern=\\d* ng-model=lockerNumber name=lockerNumber> <input class="btn btn-primary" type=submit value="Pick it up!"><p ng-show=pickupMessage>{{pickupMessage}}</p></form></p></div></div></div><footer class=footer><div class=container><p><a href=https://twitter.com/danielmarlow>@danielmarlow</a> | <a href=https://github.com/DanielMarlow/lockers>GitHub</a></p></div></footer>'),a.put("components/navbar/navbar.html",'<div class="navbar navbar-default navbar-static-top" ng-controller=NavbarCtrl><div class=container><div class=navbar-header><button class=navbar-toggle type=button ng-click="isCollapsed = !isCollapsed"><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="/" class=navbar-brand>lockers</a></div><div collapse=isCollapsed class="navbar-collapse collapse" id=navbar-main><ul class="nav navbar-nav"><li ng-repeat="item in menu" ng-class="{active: isActive(item.link)}"><a ng-href={{item.link}}>{{item.title}}</a></li></ul></div></div></div>')}]);